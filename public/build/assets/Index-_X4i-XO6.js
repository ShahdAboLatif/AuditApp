import{c as Ye,r as J,j as t,a as Ee,H as $e}from"./app-rOyHO9Rd.js";import{A as ze}from"./app-layout-INM8-aEI.js";import{c as Ae}from"./app-logo-icon-yZ7-xYF8.js";import{R as He}from"./refresh-cw-TGnfHyBX.js";import"./app-KQAryUus.js";import"./index-RfzFmWyn.js";import"./index-C2AIlcfF.js";import"./index-BH0NSEIh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Me=Ae("Download",Le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Oe=Ae("Filter",qe);function at(s){const e=Ye.c(118),{auth:h,reportData:De,stores:q,groups:O,filters:f}=s,[r,we]=J.useState(f.report_type||""),[n,ke]=J.useState(f.store_id||""),[o,Ce]=J.useState(f.group||"");let K;e[0]!==f.year?(K=f.year||new Date().getFullYear(),e[0]=f.year,e[1]=K):K=e[1];const[i,Re]=J.useState(K),[a,Fe]=J.useState(f.week||1);let P;e[2]!==o||e[3]!==r||e[4]!==n||e[5]!==a||e[6]!==i?(P=()=>{Ee.get("/camera-reports",{report_type:r,store_id:n,group:o,year:i,week:a},{preserveState:!0,preserveScroll:!0})},e[2]=o,e[3]=r,e[4]=n,e[5]=a,e[6]=i,e[7]=P):P=e[7];const U=P;let Q;e[8]===Symbol.for("react.memo_cache_sentinel")?(Q=()=>{we(""),ke(""),Ce(""),Re(new Date().getFullYear()),Fe(1),Ee.get("/camera-reports")},e[8]=Q):Q=e[8];const Ge=Q,Ie=Ze,We=Qe,{summary:V,entities:x,total_stores:B,scoreData:g}=De;let b,c,d,j,m,y,_,N,v,S,u;if(e[9]!==U||e[10]!==h.user||e[11]!==x||e[12]!==o||e[13]!==O||e[14]!==r||e[15]!==g||e[16]!==n||e[17]!==q||e[18]!==V||e[19]!==B||e[20]!==a||e[21]!==i){const Z={};x.forEach(l=>{const Se=l.category?.id??0,p=l.category?.label??"Uncategorized";Z[p]||(Z[p]={id:Se,label:p,entities:[]}),Z[p].entities.push(l)});const ve=Object.values(Z);b=ze,j=h.user,e[33]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx($e,{title:"Camera Reports"}),e[33]=m):m=e[33],S="flex flex-1 flex-col gap-6 p-4 pt-0";let ee;e[34]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Camera Reports"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Summary of ratings per store and entity"})]}),e[34]=ee):ee=e[34],e[35]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsxs("div",{className:"flex items-center justify-between",children:[ee,t.jsxs("button",{onClick:Ie,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors",children:[t.jsx(Me,{className:"h-4 w-4"}),"Export"]})]}),e[35]=u):u=e[35];let te;e[36]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 px-6 py-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Oe,{className:"h-5 w-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]})}),e[36]=te):te=e[36];let se;e[37]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e[37]=se):se=e[37];let le;e[38]===Symbol.for("react.memo_cache_sentinel")?(le=l=>we(l.target.value),e[38]=le):le=e[38];let re,ne,oe;e[39]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("option",{value:"",children:"All Types"}),ne=t.jsx("option",{value:"main",children:"Main"}),oe=t.jsx("option",{value:"secondary",children:"Secondary"}),e[39]=re,e[40]=ne,e[41]=oe):(re=e[39],ne=e[40],oe=e[41]);let F;e[42]!==r?(F=t.jsxs("div",{className:"space-y-2",children:[se,t.jsxs("select",{value:r,onChange:le,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[re,ne,oe]})]}),e[42]=r,e[43]=F):F=e[43];let ie;e[44]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("label",{className:"text-sm font-medium",children:"Store"}),e[44]=ie):ie=e[44];let ae;e[45]===Symbol.for("react.memo_cache_sentinel")?(ae=l=>ke(l.target.value),e[45]=ae):ae=e[45];let ce;e[46]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx("option",{value:"",children:"All Stores"}),e[46]=ce):ce=e[46];let T;e[47]!==q?(T=q.map(Pe),e[47]=q,e[48]=T):T=e[48];let E;e[49]!==n||e[50]!==T?(E=t.jsxs("div",{className:"space-y-2",children:[ie,t.jsxs("select",{value:n,onChange:ae,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ce,T]})]}),e[49]=n,e[50]=T,e[51]=E):E=e[51];let de;e[52]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("label",{className:"text-sm font-medium",children:"Group"}),e[52]=de):de=e[52];let me;e[53]===Symbol.for("react.memo_cache_sentinel")?(me=l=>Ce(l.target.value),e[53]=me):me=e[53];let ue;e[54]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx("option",{value:"",children:"All Groups"}),e[54]=ue):ue=e[54];let A;e[55]!==O?(A=O.map(Ke),e[55]=O,e[56]=A):A=e[56];let D;e[57]!==o||e[58]!==A?(D=t.jsxs("div",{className:"space-y-2",children:[de,t.jsxs("select",{value:o,onChange:me,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ue,A]})]}),e[57]=o,e[58]=A,e[59]=D):D=e[59];let G;e[60]!==F||e[61]!==E||e[62]!==D?(G=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[F,E,D]}),e[60]=F,e[61]=E,e[62]=D,e[63]=G):G=e[63];let fe;e[64]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx("label",{className:"text-sm font-medium",children:"Year"}),e[64]=fe):fe=e[64];let xe;e[65]===Symbol.for("react.memo_cache_sentinel")?(xe=l=>Re(Number(l.target.value)),e[65]=xe):xe=e[65];let I;e[66]!==i?(I=t.jsxs("div",{className:"space-y-2",children:[fe,t.jsx("input",{type:"number",value:i,onChange:xe,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[66]=i,e[67]=I):I=e[67];let pe;e[68]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx("label",{className:"text-sm font-medium",children:"Week"}),e[68]=pe):pe=e[68];let he;e[69]===Symbol.for("react.memo_cache_sentinel")?(he=l=>Fe(Number(l.target.value)),e[69]=he):he=e[69];let W;e[70]!==a?(W=t.jsx("input",{type:"number",min:1,max:53,value:a,onChange:he,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"}),e[70]=a,e[71]=W):W=e[71];let ge;e[72]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx("p",{className:"text-xs text-muted-foreground",children:"Weeks start on Tuesday"}),e[72]=ge):ge=e[72];let Y;e[73]!==W?(Y=t.jsxs("div",{className:"space-y-2",children:[pe,W,ge]}),e[73]=W,e[74]=Y):Y=e[74];let $;e[75]!==I||e[76]!==Y?($=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I,Y]}),e[75]=I,e[76]=Y,e[77]=$):$=e[77];let be;e[78]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx(He,{className:"h-4 w-4"}),e[78]=be):be=e[78];let z;e[79]!==U?(z=t.jsxs("button",{onClick:U,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:[be,"Apply Filters"]}),e[79]=U,e[80]=z):z=e[80];let je;e[81]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("button",{onClick:Ge,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",children:"Reset"}),e[81]=je):je=e[81];let H;e[82]!==z?(H=t.jsxs("div",{className:"flex gap-2 pt-2",children:[z,je]}),e[82]=z,e[83]=H):H=e[83],e[84]!==G||e[85]!==$||e[86]!==H?(c=t.jsxs("div",{className:"rounded-lg border bg-card",children:[te,t.jsxs("div",{className:"p-6 space-y-4",children:[G,$,H]})]}),e[84]=G,e[85]=$,e[86]=H,e[87]=c):c=e[87];let L;e[88]!==B?(L=t.jsx("span",{className:"font-semibold text-foreground",children:B}),e[88]=B,e[89]=L):L=e[89];let M;e[90]!==x.length?(M=t.jsx("span",{className:"font-semibold text-foreground",children:x.length}),e[90]=x.length,e[91]=M):M=e[91],e[92]!==L||e[93]!==M?(d=t.jsx("div",{className:"rounded-lg border bg-card p-4",children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",L," ","stores â€¢"," ",M," ","entities"]})}),e[92]=L,e[93]=M,e[94]=d):d=e[94],v="rounded-lg border bg-card overflow-x-auto",_="w-full caption-bottom text-sm border-separate border-spacing-0";let ye;e[95]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsx("th",{rowSpan:2,className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground sticky left-0 bg-muted/50 z-10",style:{minWidth:120},children:"Store"}),e[95]=ye):ye=e[95];let _e,Ne;e[96]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Score Without Auto Fail"}),Ne=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Total Score"}),e[96]=_e,e[97]=Ne):(_e=e[96],Ne=e[97]),N=t.jsxs("thead",{className:"border-b bg-muted/50",children:[t.jsxs("tr",{children:[ye,ve.map(Je),_e,Ne]}),t.jsx("tr",{children:ve.map(Ue)})]}),y=V.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:x.length+3,className:"h-24 text-center text-muted-foreground",children:"No data found. Try adjusting your filters."})}):V.map(l=>t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsxs("td",{className:"p-4 align-middle sticky left-0 bg-background z-10",children:[t.jsx("div",{className:"font-medium",children:l.store_name}),l.store_group&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Group ",l.store_group]})]}),ve.map(Se=>Se.entities.map(p=>{const Te=We(l,p.id);return t.jsx("td",{className:"p-4 align-middle text-center",children:Te?t.jsx("div",{className:"text-xs whitespace-pre-line",children:Te}):t.jsx("span",{className:"text-muted-foreground",children:"-"})},p.id)})),t.jsx("td",{className:"p-4 align-middle text-center",children:g[l.store_id]?.score_without_auto_fail!==null?g[l.store_id]?.score_without_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"p-4 align-middle text-center",children:typeof g[l.store_id]?.score_with_auto_fail=="number"?g[l.store_id].score_with_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})})]},l.store_id)),e[9]=U,e[10]=h.user,e[11]=x,e[12]=o,e[13]=O,e[14]=r,e[15]=g,e[16]=n,e[17]=q,e[18]=V,e[19]=B,e[20]=a,e[21]=i,e[22]=b,e[23]=c,e[24]=d,e[25]=j,e[26]=m,e[27]=y,e[28]=_,e[29]=N,e[30]=v,e[31]=S,e[32]=u}else b=e[22],c=e[23],d=e[24],j=e[25],m=e[26],y=e[27],_=e[28],N=e[29],v=e[30],S=e[31],u=e[32];let w;e[98]!==y?(w=t.jsx("tbody",{children:y}),e[98]=y,e[99]=w):w=e[99];let k;e[100]!==w||e[101]!==_||e[102]!==N?(k=t.jsxs("table",{className:_,children:[N,w]}),e[100]=w,e[101]=_,e[102]=N,e[103]=k):k=e[103];let C;e[104]!==k||e[105]!==v?(C=t.jsx("div",{className:v,children:k}),e[104]=k,e[105]=v,e[106]=C):C=e[106];let R;e[107]!==c||e[108]!==d||e[109]!==C||e[110]!==S||e[111]!==u?(R=t.jsxs("div",{className:S,children:[u,c,d,C]}),e[107]=c,e[108]=d,e[109]=C,e[110]=S,e[111]=u,e[112]=R):R=e[112];let X;return e[113]!==b||e[114]!==j||e[115]!==m||e[116]!==R?(X=t.jsxs(b,{user:j,children:[m,R]}),e[113]=b,e[114]=j,e[115]=m,e[116]=R,e[117]=X):X=e[117],X}function Ue(s){return s.entities.map(Be)}function Be(s){return t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground",children:t.jsx("span",{children:s.entity_label})},s.id)}function Je(s){return t.jsx("th",{className:"text-center align-middle font-bold bg-muted/50 text-[15px]",colSpan:s.entities.length,children:s.label},s.label)}function Ke(s){return t.jsxs("option",{value:s,children:["Group ",s]},s)}function Pe(s){return t.jsx("option",{value:s.id,children:s.store},s.id)}function Qe(s,e){const h=s.entities[e];return h?h.rating_counts.filter(Xe).map(Ve).join(", "):""}function Ve(s){return`${s.count} ${s.rating_label||"No Rating"}`}function Xe(s){return s.count>0}function Ze(){alert("Export feature coming soon!")}export{at as default};
