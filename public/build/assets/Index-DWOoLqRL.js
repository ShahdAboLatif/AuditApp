import{c as ke,r as m,j as t,a as R,H as Ae}from"./app-rOyHO9Rd.js";import{X as ce,F as Fe,A as De}from"./app-layout-INM8-aEI.js";import{S as xe,P as je}from"./save-BMnTYymw.js";import{F as Ie}from"./file-text-DblCskrq.js";import{S as Ne,T as ve}from"./trash-2-brF9xrc_.js";import"./app-KQAryUus.js";import"./app-logo-icon-yZ7-xYF8.js";import"./index-RfzFmWyn.js";import"./index-C2AIlcfF.js";import"./index-BH0NSEIh.js";function Ke(r){const e=ke.c(91),{auth:me,entities:g,categories:i}=r,[h,pe]=m.useState(!1),[o,ue]=m.useState(null),[f,ge]=m.useState(""),[p,H]=m.useState(""),[b,he]=m.useState(!1),[c,fe]=m.useState(null);let U;e[0]===Symbol.for("react.memo_cache_sentinel")?(U={entity_label:"",category_id:"",date_range_type:"daily",report_type:""},e[0]=U):U=e[0];const[n,y]=m.useState(U);let W;e[1]===Symbol.for("react.memo_cache_sentinel")?(W={entity_label:"",category_id:"",date_range_type:"daily",report_type:""},e[1]=W):W=e[1];const[a,u]=m.useState(W);let q;e[2]===Symbol.for("react.memo_cache_sentinel")?(q={},e[2]=q):q=e[2];const[L,d]=m.useState(q);let O;e[3]!==f?(O=s=>{s.preventDefault(),R.post("/categories",{label:f},{preserveScroll:!0,onSuccess:()=>{ge(""),pe(!1),d({})},onError:l=>d(l)})},e[3]=f,e[4]=O):O=e[4];const be=O;let X;e[5]===Symbol.for("react.memo_cache_sentinel")?(X=s=>{ue(s.id),H(s.label),d({})},e[5]=X):X=e[5];const _e=X;let z;e[6]!==p||e[7]!==o?(z=s=>{s.preventDefault(),o&&R.put(`/categories/${o}`,{label:p},{preserveScroll:!0,onSuccess:()=>{ue(null),H(""),d({})},onError:l=>d(l)})},e[6]=p,e[7]=o,e[8]=z):z=e[8];const M=z,Se=Pe;let B;e[9]!==n?(B=s=>{s.preventDefault(),R.post("/entities",{...n,category_id:n.category_id||null,report_type:n.report_type||null},{preserveScroll:!0,onSuccess:()=>{y({entity_label:"",category_id:"",date_range_type:"daily",report_type:""}),he(!1),d({})},onError:l=>d(l)})},e[9]=n,e[10]=B):B=e[10];const ye=B;let G;e[11]===Symbol.for("react.memo_cache_sentinel")?(G=s=>{fe(s.id),u({entity_label:s.entity_label,category_id:s.category_id?.toString()||"",date_range_type:s.date_range_type,report_type:s.report_type||""}),d({})},e[11]=G):G=e[11];const Ce=G;let J;e[12]!==a||e[13]!==c?(J=s=>{s.preventDefault(),c&&R.put(`/entities/${c}`,{...a,category_id:a.category_id||null,report_type:a.report_type||null},{preserveScroll:!0,onSuccess:()=>{fe(null),u({entity_label:"",category_id:"",date_range_type:"daily",report_type:""}),d({})},onError:l=>d(l)})},e[12]=a,e[13]=c,e[14]=J):J=e[14];const P=J,we=Re,Ee=me.user;let K;e[15]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx(Ae,{title:"Entities & Categories"}),e[15]=K):K=e[15];let Q;e[16]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Entities & Categories"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage inspection entities and their categories"})]}),e[16]=Q):Q=e[16];let V,Y;e[17]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:t.jsx(Fe,{className:"h-5 w-5 text-primary"})}),Y=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Categories"}),e[17]=V,e[18]=Y):(V=e[17],Y=e[18]);let j;e[19]!==i.length?(j=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[V,t.jsxs("div",{children:[Y,t.jsx("p",{className:"text-2xl font-bold",children:i.length})]})]})}),e[19]=i.length,e[20]=j):j=e[20];let Z,ee;e[21]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx("div",{className:"rounded-full bg-accent/50 p-3",children:t.jsx(Ie,{className:"h-5 w-5 text-accent-foreground"})}),ee=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Entities"}),e[21]=Z,e[22]=ee):(Z=e[21],ee=e[22]);let N;e[23]!==g.length?(N=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[Z,t.jsxs("div",{children:[ee,t.jsx("p",{className:"text-2xl font-bold",children:g.length})]})]})}),e[23]=g.length,e[24]=N):N=e[24];let v;e[25]!==j||e[26]!==N?(v=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[j,N]}),e[25]=j,e[26]=N,e[27]=v):v=e[27];let te,se;e[28]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx("h3",{className:"text-lg font-semibold",children:"Categories"}),se=()=>pe(!0),e[28]=te,e[29]=se):(te=e[28],se=e[29]);let le;e[30]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(je,{className:"h-3 w-3"}),e[30]=le):le=e[30];let _;e[31]!==h?(_=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[te,t.jsxs("button",{onClick:se,disabled:h,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[le,"Add"]})]}),e[31]=h,e[32]=_):_=e[32];let re;e[33]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category Name"}),t.jsx("th",{className:"h-10 px-4 text-center font-medium text-muted-foreground",children:"Entities"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[33]=re):re=e[33];let S;e[34]!==L||e[35]!==be||e[36]!==h||e[37]!==f?(S=h&&t.jsxs("tr",{className:"border-b bg-accent/5",children:[t.jsxs("td",{className:"p-3",colSpan:2,children:[t.jsx("input",{type:"text",placeholder:"Category name",value:f,onChange:s=>ge(s.target.value),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),L.label&&t.jsx("p",{className:"text-xs text-destructive mt-1",children:L.label})]}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:be,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground hover:bg-primary/90",children:t.jsx(xe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{pe(!1),ge(""),d({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border hover:bg-accent",children:t.jsx(ce,{className:"h-3 w-3"})})]})})]}),e[34]=L,e[35]=be,e[36]=h,e[37]=f,e[38]=S):S=e[38];let C;if(e[39]!==i||e[40]!==p||e[41]!==o||e[42]!==M){let s;e[44]!==p||e[45]!==o||e[46]!==M?(s=l=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:o===l.id?t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3",colSpan:2,children:t.jsx("input",{type:"text",value:p,onChange:x=>H(x.target.value),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:M,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(xe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{ue(null),H(""),d({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ce,{className:"h-3 w-3"})})]})})]}):t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3 font-medium",children:l.label}),t.jsx("td",{className:"p-3 text-center",children:t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted",children:l.entities_count||0})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>_e(l),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Ne,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>Se(l.id,l.label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(ve,{className:"h-3 w-3"})})]})})]})},l.id),e[44]=p,e[45]=o,e[46]=M,e[47]=s):s=e[47],C=i.map(s),e[39]=i,e[40]=p,e[41]=o,e[42]=M,e[43]=C}else C=e[43];let w;e[48]!==S||e[49]!==C?(w=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[re,t.jsxs("tbody",{children:[S,C]})]})}),e[48]=S,e[49]=C,e[50]=w):w=e[50];let E;e[51]!==_||e[52]!==w?(E=t.jsxs("div",{className:"rounded-lg border bg-card",children:[_,w]}),e[51]=_,e[52]=w,e[53]=E):E=e[53];let ae,ne;e[54]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx("h3",{className:"text-lg font-semibold",children:"Entities"}),ne=()=>he(!0),e[54]=ae,e[55]=ne):(ae=e[54],ne=e[55]);let ie;e[56]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(je,{className:"h-3 w-3"}),e[56]=ie):ie=e[56];let k;e[57]!==b?(k=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[ae,t.jsxs("button",{onClick:ne,disabled:b,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[ie,"Add"]})]}),e[57]=b,e[58]=k):k=e[58];let de;e[59]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Entity Name"}),t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[59]=de):de=e[59];let A;e[60]!==i||e[61]!==ye||e[62]!==b||e[63]!==n?(A=b&&t.jsx("tr",{className:"border-b bg-accent/5",children:t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",placeholder:"Entity name",value:n.entity_label,onChange:s=>y({...n,entity_label:s.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),t.jsxs("select",{value:n.category_id,onChange:s=>y({...n,category_id:s.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),i.map(Te)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:n.date_range_type,onChange:s=>y({...n,date_range_type:s.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:n.report_type,onChange:s=>y({...n,report_type:s.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsxs("button",{onClick:ye,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:[t.jsx(xe,{className:"h-3 w-3"})," Save"]}),t.jsxs("button",{onClick:()=>{he(!1),y({entity_label:"",category_id:"",date_range_type:"daily",report_type:""}),d({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:[t.jsx(ce,{className:"h-3 w-3"})," Cancel"]})]})]})})}),e[60]=i,e[61]=ye,e[62]=b,e[63]=n,e[64]=A):A=e[64];let F;if(e[65]!==i||e[66]!==a||e[67]!==c||e[68]!==g||e[69]!==P){let s;e[71]!==i||e[72]!==a||e[73]!==c||e[74]!==P?(s=l=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:c===l.id?t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:a.entity_label,onChange:x=>u({...a,entity_label:x.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm"}),t.jsxs("select",{value:a.category_id,onChange:x=>u({...a,category_id:x.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),i.map($e)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:a.date_range_type,onChange:x=>u({...a,date_range_type:x.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:a.report_type,onChange:x=>u({...a,report_type:x.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:P,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(xe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{fe(null),u({entity_label:"",category_id:"",date_range_type:"daily",report_type:""}),d({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ce,{className:"h-3 w-3"})})]})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("td",{className:"p-3 font-medium",children:[l.entity_label,t.jsxs("div",{className:"flex gap-1 mt-1",children:[t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-muted",children:l.date_range_type}),l.report_type&&t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-accent/30",children:l.report_type})]})]}),t.jsx("td",{className:"p-3",children:l.category?t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:l.category.label}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"No category"})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>Ce(l),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Ne,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>we(l.id,l.entity_label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(ve,{className:"h-3 w-3"})})]})})]})},l.id),e[71]=i,e[72]=a,e[73]=c,e[74]=P,e[75]=s):s=e[75],F=g.map(s),e[65]=i,e[66]=a,e[67]=c,e[68]=g,e[69]=P,e[70]=F}else F=e[70];let D;e[76]!==A||e[77]!==F?(D=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[de,t.jsxs("tbody",{children:[A,F]})]})}),e[76]=A,e[77]=F,e[78]=D):D=e[78];let I;e[79]!==k||e[80]!==D?(I=t.jsxs("div",{className:"rounded-lg border bg-card",children:[k,D]}),e[79]=k,e[80]=D,e[81]=I):I=e[81];let $;e[82]!==E||e[83]!==I?($=t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[E,I]}),e[82]=E,e[83]=I,e[84]=$):$=e[84];let T;e[85]!==v||e[86]!==$?(T=t.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4 pt-0",children:[Q,v,$]}),e[85]=v,e[86]=$,e[87]=T):T=e[87];let oe;return e[88]!==me.user||e[89]!==T?(oe=t.jsxs(De,{user:Ee,children:[K,T]}),e[88]=me.user,e[89]=T,e[90]=oe):oe=e[90],oe}function $e(r){return t.jsx("option",{value:r.id,children:r.label},r.id)}function Te(r){return t.jsx("option",{value:r.id,children:r.label},r.id)}function Re(r,e){confirm(`Delete entity "${e}"?`)&&R.delete(`/entities/${r}`,{preserveScroll:!0,onError:Me})}function Me(r){return alert(r.error||"Failed to delete")}function Pe(r,e){confirm(`Delete category "${e}"?`)&&R.delete(`/categories/${r}`,{preserveScroll:!0,onError:He})}function He(r){return alert(r.error||"Failed to delete")}export{Ke as default};
